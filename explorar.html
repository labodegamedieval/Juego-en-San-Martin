<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>🗺️🧭 Explora San Martín del Castañar</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    body {
      background: url('images/pergamino.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: 'Georgia', serif;
      color: #3b241b;
      padding: 0;
      margin: 0;
    }
    .container {
      max-width: 850px;
      margin: auto;
      background: rgba(255, 248, 228, 0.95);
      border: 3px solid #5a3b2b;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 0 20px rgba(0,0,0,0.3);
      position: relative;
    }
    header, .progress-container, .map-description, .qr-section, .button-group, footer {
      transition: opacity 0.3s ease;
    }
    #map {
      height: 400px;
      width: 100%;
      border: 3px solid #8b5e3c;
      border-radius: 10px;
      position: relative;
    }
    .compass-container {
      display: flex;
      justify-content: flex-end;
      padding-top: 10px;
    }
    #compass {
      width: 48px;
      height: 48px;
      transform: rotate(0deg);
      transition: transform 0.5s linear;
      border: 2px solid black;
      border-radius: 50%;
      padding: 4px;
      background: white;
    }
    .marker-emoji {
      font-size: 36px;
      transition: transform 0.2s ease;
      filter: drop-shadow(0 0 2px #000);
      user-select: none;
    }
    .marker-emoji.clicked {
      transform: scale(1.4);
    }
    .button-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
      margin: 20px 0;
    }
    .button-row a {
      background: rgba(255, 248, 228, 0.85);
      border: 2px solid #8b5e3c;
      border-radius: 12px;
      padding: 10px 16px;
      text-decoration: none;
      font-size: 18px;
      font-weight: bold;
      color: #3b241b;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
      backdrop-filter: blur(2px);
    }
    footer {
      text-align: center;
      font-style: italic;
      font-size: 14px;
      margin-top: 40px;
    }
  </style>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-GE0YB9PL8Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-GE0YB9PL8Q');
  </script>
</head>
<body>
  <div class="container" id="main-container">
    <header>
      <h1 data-i18n="titulo">🧙‍♂️🔍 Busca el Mensaje Oculto de Gonzalo</h1>
    </header>

    <div class="progress-container">
      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill"></div>
      </div>
      <p id="progress-text" data-i18n="progreso">Paradas completadas: 0/7</p>

      <div class="button-row">
        <a href="index.html" data-i18n="inicio">🏠 Inicio</a>
        <a href="guia.html" data-i18n="guia">📖 Guía</a>
        <a href="ranking.html" data-i18n="ranking">📊 Ranking</a>
        <a href="cronica.html" data-i18n="cronica">📜 Crónica</a>
      </div>
    </div>

    <div class="map-explanation">
      <h2 data-i18n="explicacion_titulo">ℹ️ ¿Cómo funciona este juego?</h2>
      <p data-i18n="explicacion_1">Texto explicativo del juego.</p>
      <p data-i18n="explicacion_2">Instrucciones de uso del mapa.</p>
    </div>

    <div class="map-container">
      <div id="map"></div>
      <p class="map-description" data-i18n="descripcion_mapa">Mapa interactivo de San Martín del Castañar</p>
    </div>
    <div class="compass-container">
      <img src="images/flecha.png" id="compass" alt="Brújula" />
    </div>
  </div>

  <footer>
    <p>© 2025 La Bodega Medieval | <a href="https://www.labodegamedieval.es" target="_blank" data-i18n="reserva">Reserva tu visita</a></p>
  </footer>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const translations = {
      es: {
        titulo: "🧙‍♂️🔍 Busca el Mensaje Oculto de Gonzalo",
        progreso: "Paradas completadas: 0/7",
        inicio: "🏠 Inicio",
        guia: "📖 Guía",
        ranking: "📊 Ranking",
        cronica: "📜 Crónica",
        explicacion_titulo: "ℹ️ ¿Cómo funciona este juego?",
        explicacion_1: "Este mapa muestra las distintas paradas del recorrido por San Martín del Castañar. En cada parada te espera una prueba o enigma que deberás resolver para desbloquear fragmentos del mensaje oculto de Gonzalo.",
        explicacion_2: "Pulsa sobre los iconos del mapa para acceder a cada prueba. Algunas paradas se desbloquean al avanzar en el juego. Usa la brújula para orientarte y sigue tu progreso con la barra de arriba.",
        descripcion_mapa: "Mapa interactivo de San Martín del Castañar",
        reserva: "Reserva tu visita"
      },
      en: {
        titulo: "🧙‍♂️🔍 Discover Gonzalo's Hidden Message",
        progreso: "Stops completed: 0/7",
        inicio: "🏠 Home",
        guia: "📖 Guide",
        ranking: "📊 Ranking",
        cronica: "📜 Chronicle",
        explicacion_titulo: "ℹ️ How does this game work?",
        explicacion_1: "This map shows the different stops along the route through San Martín del Castañar. Each stop presents a challenge or riddle to unlock fragments of Gonzalo's hidden message.",
        explicacion_2: "Click on the icons to access each stop. Some are unlocked as you progress. Use the compass to orient yourself and follow your progress with the bar above.",
        descripcion_mapa: "Interactive map of San Martín del Castañar",
        reserva: "Book your visit"
      },
      fr: {
        titulo: "🧙‍♂️🔍 Découvre le Message Caché de Gonzalo",
        progreso: "Étapes terminées : 0/7",
        inicio: "🏠 Accueil",
        guia: "📖 Guide",
        ranking: "📊 Classement",
        cronica: "📜 Chronique",
        explicacion_titulo: "ℹ️ Comment fonctionne ce jeu ?",
        explicacion_1: "Cette carte présente les différentes étapes du parcours à San Martín del Castañar. Chaque arrêt propose une épreuve ou une énigme pour débloquer des fragments du message caché de Gonzalo.",
        explicacion_2: "Clique sur les icônes de la carte pour accéder à chaque arrêt. Certains se débloquent au fur et à mesure. Utilise la boussole pour t’orienter et suis ta progression avec la barre ci-dessus.",
        descripcion_mapa: "Carte interactive de San Martín del Castañar",
        reserva: "Réserve ta visite"
      },
      de: {
        titulo: "🧙‍♂️🔍 Finde Gonzalos Versteckte Botschaft",
        progreso: "Beendete Stationen: 0/7",
        inicio: "🏠 Startseite",
        guia: "📖 Anleitung",
        ranking: "📊 Rangliste",
        cronica: "📜 Chronik",
        explicacion_titulo: "ℹ️ Wie funktioniert dieses Spiel?",
        explicacion_1: "Diese Karte zeigt die verschiedenen Stationen der Route durch San Martín del Castañar. An jeder Station wartet ein Rätsel, um Fragmente von Gonzalos geheimer Botschaft freizuschalten.",
        explicacion_2: "Klicke auf die Symbole auf der Karte, um zu jeder Station zu gelangen. Einige Stationen werden erst später freigeschaltet. Nutze den Kompass zur Orientierung und verfolge deinen Fortschritt oben.",
        descripcion_mapa: "Interaktive Karte von San Martín del Castañar",
        reserva: "Buche deinen Besuch"
      }
    };

    const lang = localStorage.getItem("language") || "es";
    const t = translations[lang] || translations.es;
    document.querySelectorAll("[data-i18n]").forEach(el => {
      const key = el.getAttribute("data-i18n");
      if (t[key]) el.innerHTML = t[key];
    });
  </script>
</body>
</html>
