<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üç∑ La Bodega Medieval</title>
  <link rel="stylesheet" href="styles/style.css"/>
  <link rel="icon" type="image/jpeg" href="images/escudo-borrado.jpg"/>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: url('images/fondo-bodega.jpg') no-repeat center center fixed;
      background-size: cover;
      margin: 0;
      padding: 0;
      color: #333;
    }
    .container {
      max-width: 960px;
      margin: auto;
      background: rgba(255,248,228,0.95);
      border: 3px double #5e3b1b;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 0 15px rgba(0,0,0,0.4);
      position: relative;
    }
    header h1 { text-align: center; }
    .action-btn {
      display: inline-block;
      margin: 5px;
      padding: 10px 20px;
      font-size: 16px;
      background: #dec79b;
      border: 2px solid #5e3b1b;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    .music-control { text-align: center; margin-bottom: 10px; }

    #location-check {
      text-align: center;
      margin-bottom: 30px;
    }
    #location-check input {
      padding: 8px;
      font-size: 16px;
      width: 200px;
      margin: 10px;
      border: 1px solid #5e3b1b;
      border-radius: 4px;
    }
    #location-status { margin-top: 10px; font-size: 1.1em; color: red; }
    #direction-arrow { width: 50px; margin-top: 10px; }

    .carousel {
      position: relative;
      overflow: hidden;
      width: 100%;
      margin-bottom: 20px;
      border-radius: 10px;
      border: 2px solid #5e3b1b;
    }
    .carousel .slide {
      display: none;
      text-align: center;
    }
    .carousel .slide.active { display: block; }
    .carousel img {
      width: 100%;
      height: 300px;
      object-fit: cover;
      border-radius: 10px;
      border: 2px solid #6e3e2e;
    }
    .carousel .slide p {
      font-family: Georgia, serif;
      font-size: 16px;
      color: #2e2e2e;
      line-height: 1.5;
      margin: 10px auto;
      max-width: 800px;
    }
    .carousel .slide a {
      color: #5e3b1b;
      text-decoration: underline;
    }
    .carousel .slide a:hover { color: #a65c3a; }
    .carousel-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255,255,255,0.7);
      border: none;
      font-size: 24px;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
    }
    .prev-slide { left: 10px; }
    .next-slide { right: 10px; }

    footer p {
      text-align: center;
      font-size: 0.9em;
      margin-top: 20px;
    }
    .container:before {
      content: "üçá";
      position: absolute;
      top: 10px;
      left: 10px;
      font-size: 32px;
      color: #5e3b1b;
    }
    .container:after {
      content: "üç∑";
      position: absolute;
      bottom: 10px;
      right: 10px;
      font-size: 32px;
      color: #5e3b1b;
    }
    @media screen and (max-width: 768px) {
      .container { max-width: 90%; }
      .carousel img { height: 200px; }
      .carousel-btn { font-size: 20px; padding: 6px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üç∑ La Bodega Medieval</h1>
      <div class="music-control">
        <button class="action-btn music-btn" onclick="toggleMusic()">
          <span class="music-icon">üéµ</span> M√∫sica
        </button>
      </div>
    </header>

    <section id="content">
      <div class="stop-icon">üç∑</div>
      <div id="location-check">
        <h2>Verifica tu ubicaci√≥n</h2>
        <p>Ac√©rcate al escudo tallado sobre la puerta de la bodega para continuar.</p>
        <button class="action-btn" onclick="checkLocation()">Verificar GPS</button>
        <p>O escribe el nombre:</p>
        <input type="text" id="location-input" placeholder="Ej: Bodega" />
        <button class="action-btn" onclick="checkLocationManual()">Verificar Manual</button>
        <p id="location-status"></p>
        <img id="direction-arrow" src="images/flecha.png" class="arrow-icon" style="display: none;" />
      </div>

      <div id="game-content" style="display: none;">
        <div class="carousel">
          <div class="slide active">
            <img src="images/bodega-barriles.jpeg" alt="Interior bodega" />
            <p><strong>Interior:</strong> Conserva barricas antiguas y utensilios tradicionales.  
              <a href="https://www.labodegamedieval.es/" target="_blank">M√°s informaci√≥n</a></p>
          </div>
          <div class="slide">
            <img src="images/bodega-cueva.jpeg" alt="Entrada bodega" />
            <p><strong>Entrada:</strong> Sus muros ocultan secretos y leyendas olvidadas desde hace siglos.  
              <a href="https://www.labodegamedieval.es/experiencias/" target="_blank">M√°s informaci√≥n</a></p>
          </div>
          <div class="slide">
            <img src="images/bodega-escudo.jpeg" alt="Escudo Borrado" />
            <p><strong>Escudo:</strong> El escudo tallado guarda el legado de la familia de Gonzalo de la Sierra.  
              <a href="https://www.labodegamedieval.es/la-bodega/" target="_blank">M√°s informaci√≥n</a></p>
          </div>
          <button class="carousel-btn prev-slide" onclick="prevSlide()">‚Üê</button>
          <button class="carousel-btn next-slide" onclick="nextSlide()">‚Üí</button>
        </div>

        <div id="final-game" style="display: none;">
          <h2>¬°Felicidades!</h2>
          <p>Has superado La Bodega Medieval.</p>
          <button class="action-btn" onclick="finishGame()">Finalizar b√∫squeda</button>
        </div>
      </div>
    </section>

    <footer>
      <p>¬© 2025 La Bodega Medieval |  
        <a href="https://www.labodegamedieval.es" target="_blank">Reserva tu visita</a>
      </p>
    </footer>

    <audio id="success-sound" src="sounds/success.mp3" preload="auto"></audio>
    <audio id="error-sound" src="sounds/error.mp3" preload="auto"></audio>
    <audio id="coins-sound" src="sounds/coins.mp3" preload="auto"></audio>
    <audio id="background-music" src="sounds/musica-medieval.mp3" preload="auto" loop></audio>
  </div>

  <script>
    function checkLocation() {
      document.getElementById("location-check").style.display = "none";
      document.getElementById("game-content").style.display = "block";
      playSound("background-music");
    }
    function checkLocationManual() {
      const input = document.getElementById("location-input").value.trim().toLowerCase();
      if(input === "bodega") { checkLocation(); }
      else {
        document.getElementById("location-status").textContent = "Nombre incorrecto. Int√©ntalo de nuevo.";
      }
    }
    function playSound(id) {
      const s = document.getElementById(id);
      if(s) s.play();
    }
    function toggleMusic() {
      const bg = document.getElementById('background-music');
      const btn = document.querySelector('.music-btn');
      if(bg.paused) {
        bg.play();
        btn.innerHTML = '<span class="music-icon">üéµ</span> Pausar M√∫sica';
      } else {
        bg.pause();
        btn.innerHTML = '<span class="music-icon">üîá</span> Reproducir M√∫sica';
      }
    }
    function finishGame() {
      updateRanking();
      window.location.href = "final.html?stop=bodega";
    }
    function updateRanking() {
      let ranking = JSON.parse(localStorage.getItem("ranking")) || [];
      ranking.push({ stop: "bodega", score: 100 });
      localStorage.setItem("ranking", JSON.stringify(ranking));
    }
    let currentSlide = 0;
    function showSlide(index) {
      const slides = document.querySelectorAll(".carousel .slide");
      if(index >= slides.length) { currentSlide = 0; }
      if(index < 0) { currentSlide = slides.length - 1; }
      slides.forEach((s, i) => { s.classList.toggle("active", i === currentSlide); });
    }
    function nextSlide() { currentSlide++; showSlide(currentSlide); }
    function prevSlide() { currentSlide--; showSlide(currentSlide); }
  </script>
</body>
</html>
